(function(){var t,e=function(t,e){function l(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return l.prototype=e.prototype,t.prototype=new l,t.__super__=e.prototype,t},n={}.hasOwnProperty;(t=function(t){return"object"==typeof exports&&"object"==typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){var l,r;return l=function(t){function n(t,e){n.__super__.constructor.call(this,t,e)}var l;return e(n,t),l=function(t,e,n,l,r){var a,o,s,i,u,c,h;for(u=[],a=!1,i=0,c=l.length;i<c;i++)o=l[i],u.push(null!=(h=t[o])?h:"null"),s=u.join(String.fromCharCode(0)),e[s]||(e[s]=r(u.slice()),a=!0),e[s].push(t);return a&&n.push(u),u},n.prototype.processRecord=function(t){var e,n,r,a,o,s,i,u,c,h,d,p,f;if(f=[],e=[],this.allTotal.push(t),f=l(t,this.rowTotals,this.rowKeys,this.rowAttrs,function(t){return function(e){return t.aggregator(t,e,[])}}(this)),e=l(t,this.colTotals,this.colKeys,this.colAttrs,function(t){return function(e){return t.aggregator(t,[],e)}}(this)),c=f.length-1,h=e.length-1,!(c<0||h<0)){for(p=[],s=u=0,d=c;0<=d?u<=d:u>=d;s=0<=d?++u:--u)r=f.slice(0,s+1),o=r.join(String.fromCharCode(0)),this.tree[o]||(this.tree[o]={}),p.push(function(){var l,s,u;for(u=[],i=l=0,s=h;0<=s?l<=s:l>=s;i=0<=s?++l:--l)n=e.slice(0,i+1),a=n.join(String.fromCharCode(0)),this.tree[o][a]||(this.tree[o][a]=this.aggregator(this,r,n)),u.push(this.tree[o][a].push(t));return u}.call(this));return p}},n}(t.pivotUtilities.PivotData),t.pivotUtilities.SubtotalPivotData=l,r=function(e,l){var r,a,o,s,i,u,c,h,d,p,f,g,v,C,b,y,w,A,S,x,m,k,T,H,E,R,j,K,L,_,I,O,N,W,V,q,P,U,D,B,G,Q,z,F,J,M,X,Y;return j={table:{clickCallback:null},localeStrings:{totals:"Totals"}},l=t.extend(!0,{},j,l),o=null!=l.arrowCollapsed?l.arrowCollapsed:l.arrowCollapsed="▶",s=null!=l.arrowExpanded?l.arrowExpanded:l.arrowExpanded="◢",A="expanded",w="collapsed",S=e.colAttrs,B=e.rowAttrs,G=e.getRowKeys(),x=e.getColKeys(),Y=e.tree,Q=e.rowTotals,m=e.colTotals,a=e.allTotal,V=function(t,e){var n;return n=new RegExp("(?:^|\\s)"+e+"(?!\\S)","g"),t.className.match(n)},U=function(t,e){var n;return n=new RegExp("(?:^|\\s)"+e+"(?!\\S)","g"),t.className=t.className.replace(n,"")},r=function(t,e){if(!V(t,e))return t.className+=" "+e},D=function(t,e,n){return U(t,e),r(t,n)},W=function(t,r,a){var o,s,i,u,c,h,d;if(l.table||l.table.eventHandlers){i={},d=l.table.eventHandlers;for(s in d)if(n.call(d,s)){c=d[s],u={};for(h in S)n.call(S,h)&&(o=S[h],null!=a[h]&&(u[o]=a[h]));for(h in B)n.call(B,h)&&(o=B[h],null!=r[h]&&(u[o]=r[h]));i[s]=function(n){return c(n,t,u,e)}}return i}},R=function(t,e,l,r,a){var o,s,i,u,c;if(u=document.createElement(t),null!=e&&(u.className=e),null!=l&&(u.textContent=l),null!=r)for(o in r)n.call(r,o)&&(c=r[o],u.setAttribute(o,c));if(null!=a)for(s in a)n.call(a,s)&&(i=a[s],u.addEventListener(s,i));return u},P=function(t,e){var n,l,r,a,o,s,i,u,c,h,d,p,f,g;for(l=[],s=t.length-1,o=t[0].length-1,h=[],f=R("th",e,t[0][0]),a=[],a.push(t[0][0]),u=0,i={node:u,row:0,col:0,th:f,parent:null,children:[],descendants:o,leaves:1,key:a,flatKey:a.join(String.fromCharCode(0))},l.push(i),h[0]=i,n=1;n<=o;)f=R("th",e,t[0][n]),a=a.slice(),a.push(t[0][n]),++u,i={node:u,row:0,col:n,th:f,parent:h[n-1],children:[],descendants:o-n,leaves:1,key:a,flatKey:a.join(String.fromCharCode(0))},h[n]=i,h[n-1].children.push(i),++n;for(h[o].leaves=0,c=1;c<=s;){for(p=!0,a=[],n=0;n<=o;)if(a=a.slice(),a.push(t[c][n]),t[c][n]===t[h[n].row][n]&&n!==o&&p)p=!0,++n;else{if(f=R("th",e,t[c][n]),++u,i={node:u,row:c,col:n,th:f,parent:null,children:[],descendants:0,leaves:1,key:a,flatKey:a.join(String.fromCharCode(0))},0===n)l.push(i);else for(i.parent=h[n-1],h[n-1].children.push(i),g=0;g<=n-1;)++h[g].descendants,++g;h[n]=i,p=!1,++n}for(n=r=0,d=o;0<=d?r<=d:r>=d;n=0<=d?++r:--r)++h[n].leaves;h[o].leaves=0,++c}return l},i=function(t,e,n,l,r,a){var o,i,u,c;return i=l[a],u=i,o="pvtAxisLabel",a<l.length-1&&(o+=" expanded",u=" "+s+" "+i),c=R("th",o,u),c.setAttribute("data-colAttr",i),r.appendChild(c),e.push({tr:r,th:c,clickStatus:A,expandedCount:0,nHeaders:0}),t.appendChild(r)},u=function(t,e,n,l){var r,a,o,s,u;for(u=document.createElement("tr"),0!==n.length&&u.appendChild(R("th",null,null,{colspan:n.length,rowspan:l.length})),i(t,e,n,l,u,0),s=[],r=a=1,o=l.length;1<=o?a<=o:a>=o;r=1<=o?++a:--a)r<l.length&&(u=document.createElement("tr"),s.push(i(t,e,n,l,u,r)));return s},c=function(t,e,n){var l,r,a,o,s,i,u;for(o=n.length-1,i=[],r=a=0,s=o;0<=s?a<=s:a>=s;r=0<=s?++a:--a)r<o&&(u=t[r].th,l=n[r],i.push(u.onclick=function(l){return l=l||window.event,J(t,e,n,l.target.getAttribute("data-colAttr"))}));return i},h=function(t,e,n,l,a){var o,i,u,c,d,p,f,g,v;for(d=n.children,u=0,c=d.length;u<c;u++)o=d[u],h(t,e,o,l,a);return i=t[n.col],++i.expandedCount,++i.nHeaders,v=i.tr,g=n.th,g.setAttribute("data-colHeader",g.textContent),n.col===a.length-1&&0!==l.length&&g.setAttribute("rowspan",2),0!==n.children.length&&g.setAttribute("colspan",n.descendants+1),g.setAttribute("data-node",e.length),v.appendChild(g),0!==n.children.length&&(r(g,A),g.textContent=" "+s+" "+g.textContent,g.onclick=function(n){return n=n||window.event,F(t,e,parseInt(n.target.getAttribute("data-node")))},p=a.length-(n.col+1)+(0!==l.length?1:0),f="pvtColLabel col"+n.row,g=R("th",f,"",{rowspan:p}),n.children[0].tr.appendChild(g),n.sTh=g),n.clickStatus=A,n.tr=v,e.push(n)},g=function(t,e,l,r){var a,o,i,u,c,h;h=document.createElement("tr"),e.hh=[];for(o in l)n.call(l,o)&&(i=l[o],u=i,a="pvtAxisLabel",o<l.length-1&&(a+=" expanded",u=" "+s+" "+i),c=R("th",a,u),c.setAttribute("data-rowAttr",i),h.appendChild(c),e.hh.push({th:c,clickStatus:A,expandedCount:0,nHeaders:0}));return 0!==r.length&&(c=R("th"),h.appendChild(c)),t.appendChild(h),e.tr=h},v=function(t,e,n){var l,r,a,o,s,i,u;for(a=n.length-1,s=[],l=r=0,o=a;0<=o?r<=o:r>=o;l=0<=o?++r:--r)l<a&&(u=t.hh[l],i=n[l],s.push(u.th.onclick=function(l){return l=l||window.event,X(t,e,n,l.target.getAttribute("data-rowAttr"))}));return s},b=function(t,e,n){var r,a;return r=1,0!==n.length&&(r=n.length+(0===e.length?0:1)),a=R("th","pvtTotalLabel",l.localeStrings.totals,{rowspan:r}),t.appendChild(a)},C=function(t,e,n,l,a,o){var i,u,c,h,d,p,f,g,v;for(c=e.hh[l.col],++c.expandedCount,++c.nHeaders,v=document.createElement("tr"),g=l.th,g.setAttribute("rowspan",l.descendants+1),g.setAttribute("data-rowHeader",g.textContent),l.col===a.length-1&&0!==o.length&&g.setAttribute("colspan",2),g.setAttribute("data-node",n.length),v.appendChild(g),0!==l.children.length&&(r(g,A),g.textContent=" "+s+" "+g.textContent,g.onclick=function(t){return t=t||window.event,M(e,n,parseInt(t.target.getAttribute("data-node")))},i=a.length-(l.col+1)+(0!==o.length?1:0),g=R("th","pvtRowLabel pvtRowSubtotal","",{colspan:i}),v.appendChild(g)),l.clickStatus=A,l.tr=v,n.push(l),t.appendChild(v),p=l.children,f=[],h=0,d=p.length;h<d;h++)u=p[h],f.push(C(t,e,n,u,a,o));return f},y=function(t,e){var n,l,r,a,o,s,i,u,c,h,d,p,f,g,v,C,b;for(d=[],s=0,u=t.length;s<u;s++){for(p=t[s],C=p.tr,o=p.flatKey,i=0,c=e.length;i<c;i++)l=e[i],a=l.flatKey,n=null!=(h=Y[o][a])?h:{value:function(){return null},format:function(){return""}},b=n.value(),f="pvtVal",0!==l.children.length&&(f+=" pvtColSubtotal"),0!==p.children.length&&(f+=" pvtRowSubtotal"),f+=" row"+p.row+" col"+l.row+" rowcol"+p.col+" colcol"+l.col,r=W(b,p.key,l.key),g=R("td",f,n.format(b),{"data-value":b},r),C.appendChild(g);v=Q[o],b=v.value(),f="pvtTotal rowTotal",0!==p.children.length&&(f+=" pvtRowSubtotal"),f+=" row"+p.row+" rowcol"+p.col,g=R("td",f,v.format(b),{"data-value":b,"data-row":"row"+p.row,"data-col":"col"+p.col},W(b,p.key,[])),d.push(C.appendChild(g))}return d},p=function(t,e){var n,r,a;return a=document.createElement("tr"),n=t.length+(0===e.length?0:1),r=R("th","pvtTotalLabel",l.localeStrings.totals,{colspan:n}),a.appendChild(r),a},d=function(t,e){var n,l,r,a,o,s,i,u;for(a=[],l=0,r=e.length;l<r;l++)n=e[l],i=m[n.flatKey],u=i.value(),o="pvtVal pvtTotal colTotal",0!==n.children.length&&(o+=" pvtColSubtotal"),o+=" col"+n.row+" colcol"+n.col,s=R("td",o,i.format(u),{"data-value":u,"data-for":"col"+n.col},W(u,[],n.key)),a.push(t.appendChild(s));return a},f=function(t,e){var n,l,r;return l=a,r=l.value(),n=R("td","pvtGrandTotal",l.format(r),{"data-value":r},W(r,[],[])),e.appendChild(n),t.appendChild(e)},z=function(e,n){if(n.th.style.display=e,0!==n.children.length?t(n.th).closest("table.pvtTable").find("tbody tr td.pvtColSubtotal.col"+n.row+".colcol"+n.col).css("display",e):t(n.th).closest("table.pvtTable").find("tbody tr td.pvtVal.col"+n.row).not(".pvtColSubtotal").css("display",e),n.sTh)return n.sTh.style.display=e},k=function(t,e,n){var l,r,a,s,i,u,c,h,d,p,f,g;if(e[n]&&(s=e[n],s.clickStatus!==w)){for(r=0,i=u=1,d=s.descendants;1<=d?u<=d:u>=d;i=1<=d?++u:--u)0!==s.descendants&&(a=e[n-i],"none"!==a.th.style.display&&(++r,z("none",a)));for(h=s.parent;null!==h;)h.th.setAttribute("colspan",parseInt(h.th.getAttribute("colspan"))-r),h=h.parent;if(0!==s.descendants&&(D(s.th,A,w),s.th.textContent=" "+o+" "+s.th.getAttribute("data-colHeader")),s.clickStatus=w,s.th.setAttribute("colspan",1),s.th.style.display="",l=t[s.col],l.expandedCount--,0===l.expandedCount){for(g=[],i=c=p=s.col,f=t.length-2;p<=f?c<=f:c>=f;i=p<=f?++c:--c)l=t[i],D(l.th,A,w),l.th.textContent=" "+o+" "+l.th.getAttribute("data-colAttr"),g.push(l.clickStatus=w);return g}}},K=function(t){var e,n,l,r,a;if("none"===t.th.style.display&&z("",t),t.clickStatus!==w){for(r=t.children,a=[],n=0,l=r.length;n<l;n++)e=r[n],a.push(K(e));return a}},_=function(t,e,n){var l,r,a,o,i,u,c,h;if(e[n]&&(a=e[n],a.clickStatus!==A)){for(r=0,h=a.children,i=0,u=h.length;i<u;i++)l=h[i],r+=l.th.colSpan,"none"===l.th.style.display&&z("",l),K(l);for(0!==a.descendants&&(D(a.th,w,A),a.th.textContent=" "+s+" "+a.th.getAttribute("data-colHeader")),a.th.setAttribute("colspan",r+1),a.clickStatus=A,a.th.style.display="",null!=a.sTh&&(a.sTh.style.display=""),c=a.parent;null!==c;)c.th.setAttribute("colspan",r+parseInt(c.th.getAttribute("colspan"))),c=c.parent;return o=t[a.col],++o.expandedCount,o.expandedCount===o.nHeaders?(D(o.th,w,A),o.th.textContent=" "+s+" "+o.th.getAttribute("data-colAttr"),o.clickStatus=A):void 0}},H=function(t,e,n){var l,r,a,s,i,u,c,h,d,p,f,g,v;if(e[n]&&(r=e[n],r.clickStatus!==w)){for(v=0,a=i=1,h=r.descendants;1<=h?i<=h:i>=h;a=1<=h?++i:--i)0!==r.descendants&&(l=e[n+a],"none"!==l.tr.style.display&&(++v,l.tr.style.display="none"));for(c=r.parent;null!==c;)c.th.setAttribute("rowspan",parseInt(c.th.getAttribute("rowspan")-v)),c=c.parent;if(0!==r.descendants&&(D(r.th,A,w),r.th.textContent=" "+o+" "+r.th.getAttribute("data-rowHeader")),r.clickStatus=w,r.th.setAttribute("rowspan",1),r.tr.style.display="",g=t.hh[r.col],g.expandedCount--,0===g.expandedCount){for(f=[],s=u=d=r.col,p=t.hh.length-2;d<=p?u<=p:u>=p;s=d<=p?++u:--u)g=t.hh[s],D(g.th,A,w),g.th.textContent=" "+o+" "+g.th.getAttribute("data-rowAttr"),f.push(g.clickStatus=w);return f}}},L=function(t){var e,n,l,r,a;if("none"===t.tr.style.display&&(t.tr.style.display=""),t.clickStatus!==w){for(r=t.children,a=[],n=0,l=r.length;n<l;n++)e=r[n],a.push(L(e));return a}},O=function(t,e,n){var l,r,a,o,i,u,c,h;if(e[n]&&(r=e[n],r.clickStatus!==A)){for(h=0,c=r.children,o=0,i=c.length;o<i;o++)l=c[o],h+=l.th.rowSpan,"none"===l.tr.style.display&&(l.tr.style.display=""),L(l);for(0!==r.descendants&&(D(r.th,w,A),r.th.textContent=" "+s+" "+r.th.getAttribute("data-rowHeader")),r.th.setAttribute("rowspan",h+1),r.clickStatus=A,r.tr.style.display="",u=r.parent;null!==u;)u.th.setAttribute("rowspan",h+parseInt(u.th.getAttribute("rowspan"))),u=u.parent;return a=t.hh[r.col],++a.expandedCount,a.expandedCount===a.nHeaders?(D(a.th,w,A),a.th.textContent=" "+s+" "+a.th.getAttribute("data-rowAttr"),a.clickStatus=A):void 0}},F=function(t,e,n){var l;if(null!=e[n])return l=e[n],l.clickStatus===w?_(t,e,n):k(t,e,n),l.th.scrollIntoView},M=function(t,e,n){if(null!=e[n])return e[n].clickStatus===w?O(t,e,n):H(t,e,n)},T=function(t,e,n,l){var r,a,s,i,u,c,h;if(i="string"==typeof l?n.indexOf(l):l,!(i<0||i===n.length-1)){for(s=i,u=n.length-1;s<u;)a=t[s],D(a.th,A,w),a.th.textContent=" "+o+" "+n[s],a.clickStatus=w,++s;for(s=0,c=e.length,h=[];s<c;)r=e[s],r.col===i&&r.clickStatus!==w&&"none"!==r.th.style.display&&k(t,e,parseInt(r.th.getAttribute("data-node"))),h.push(++s);return h}},I=function(t,e,n,l){var r,a,i,u,c,h,d,p,f,g;if(c="string"==typeof l?n.indexOf(l):l,!(c<0||c===n.length-1)){for(u=d=0,f=c;0<=f?d<=f:d>=f;u=0<=f?++d:--d)for(i=t[u],D(i.th,w,A),i.th.textContent=" "+s+" "+n[u],i.clickStatus=A,h=0,p=e.length;h<p;)a=e[h],a.col===u&&_(t,e,h),++h;for(++c,g=[];c<n.length-1;)r=t[c],0===r.expandedCount?(D(r.th,A,w),r.th.textContent=" "+o+" "+n[c],r.clickStatus=w):r.expandedCount===r.nHeaders&&(D(r.th,w,A),r.th.textContent=" "+s+" "+n[c],r.clickStatus=A),g.push(++c);return g}},E=function(t,e,n,l){var r,a,s,i,u,c,h;if(s="string"==typeof l?n.indexOf(l):l,!(s<0||s===n.length-1)){for(a=s,u=n.length-1;a<u;)r=t.hh[a],D(r.th,A,w),r.th.textContent=" "+o+" "+n[a],r.clickStatus=w,++a;for(i=0,c=e.length,h=[];i<c;)r=e[i],r.col===s&&r.clickStatus!==w&&"none"!==r.tr.style.display?(H(t,e,i),h.push(i=i+r.descendants+1)):h.push(++i);return h}},N=function(t,e,n,l){var r,a,i,u,c,h,d,p,f,g;if(u="string"==typeof l?n.indexOf(l):l,!(u<0||u===n.length-1)){for(i=h=0,p=u;0<=p?h<=p:h>=p;i=0<=p?++h:--h)for(a=t.hh[i],D(a.th,w,A),a.th.textContent=" "+s+" "+n[i],a.clickStatus=A,c=0,d=e.length;c<d;)r=e[c],r.col===i?(O(t,e,c),c+=r.descendants+1):++c;for(++u,f=[];u<n.length-1;)g=t.hh[u],0===g.expandedCount?(D(g.th,A,w),g.th.textContent=" "+o+" "+n[u],g.clickStatus=w):g.expandedCount===g.nHeaders&&(D(g.th,w,A),g.th.textContent=" "+s+" "+n[u],g.clickStatus=A),f.push(++u);return f}},J=function(t,e,n,l){var r,a;return a=n.indexOf(l),r=t[a],r.clickStatus===w?I(t,e,n,l):T(t,e,n,l)},X=function(t,e,n,l){var r,a;return r=n.indexOf(l),a=t.hh[r],a.clickStatus===w?N(t,e,n,l):E(t,e,n,l)},(q=function(t,e,n,r){var a,o,s,i,w,A,S,x,m,k,H,R,j,K,L;if(R=[],s=[],k={},H=[],o=[],a=[],t.length>0&&e.length>0&&(R=P(e,"pvtRowLabel")),n.length>0&&r.length>0&&(s=P(r,"pvtColLabel")),m=document.createElement("table"),m.className="pvtTable",m.style.display="none",K=document.createElement("thead"),m.appendChild(K),n.length>0){for(u(K,o,t,n),w=0,S=s.length;w<S;w++)i=s[w],h(o,a,i,t,n);c(o,a,n)}if(t.length>0&&(g(K,k,t,n),0===n.length&&b(k.tr,t,n)),n.length>0&&b(o[0].tr,t,n),j=document.createElement("tbody"),m.appendChild(j),t.length>0)for(A=0,x=R.length;A<x;A++)i=R[A],C(j,k,H,i,t,n);return v(k,H,t),y(H,a),L=p(t,n),n.length>0&&d(L,a),f(j,L),m.setAttribute("data-numrows",e.length),m.setAttribute("data-numcols",r.length),null==l.collapseRowsAt&&null==l.collapseColsAt&&(m.style.display=""),null!=l.collapseRowsAt&&setTimeout(function(){if(E(k,H,t,l.collapseRowsAt),!l.collapseColsAt)return m.style.display=""},0),null!=l.collapseColsAt&&setTimeout(function(){return T(o,a,n,l.collapseColsAt),m.style.display=""},0),m})(B,G,S,x)},t.pivotUtilities.subtotal_renderers={"Table With Subtotal":function(t,e){return r(t,e)},"Table With Subtotal Bar Chart":function(e,n){return t(r(e,n)).barchart()},"Table With Subtotal Heatmap":function(e,n){return t(r(e,n)).heatmap("heatmap",n)},"Table With Subtotal Row Heatmap":function(e,n){return t(r(e,n)).heatmap("rowheatmap",n)},"Table With Subtotal Col Heatmap":function(e,n){return t(r(e,n)).heatmap("colheatmap",n)}}})}).call(this);
//# sourceMappingURL=subtotal.min.js.map
